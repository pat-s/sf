<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2. Reading, Writing and Converting Simple Features • sf</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="2. Reading, Writing and Converting Simple Features">
<meta property="og:description" content="sf">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sf</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9-6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/sf1.html">1. Simple Features for R</a>
    </li>
    <li>
      <a href="../articles/sf2.html">2. Reading, Writing and Converting Simple Features</a>
    </li>
    <li>
      <a href="../articles/sf3.html">3. Manipulating Simple Feature Geometries</a>
    </li>
    <li>
      <a href="../articles/sf4.html">4. Manipulating Simple Features</a>
    </li>
    <li>
      <a href="../articles/sf5.html">5. Plotting Simple Features</a>
    </li>
    <li>
      <a href="../articles/sf6.html">6. Miscellaneous</a>
    </li>
    <li>
      <a href="../articles/sf7.html">7. Spherical geometry in sf using s2geometry</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/r-spatial/sf/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="sf2_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>2. Reading, Writing and Converting Simple Features</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-spatial/sf/blob/master/vignettes/sf2.Rmd"><code>vignettes/sf2.Rmd</code></a></small>
      <div class="hidden name"><code>sf2.Rmd</code></div>

    </div>

    
    
<p>This vignetted describes how simple features can be read in R from files or databases, and how they can be converted to other formats (text, <a href="https://cran.r-project.org/package=sp">sp</a>)</p>
<div id="reading-and-writing-through-gdal" class="section level2">
<h2 class="hasAnchor">
<a href="#reading-and-writing-through-gdal" class="anchor"></a>Reading and writing through GDAL</h2>
<p>The Geospatial Data Abstraction Library (<a href="http://www.gdal.org/">GDAL</a>) is the swiss army knife for spatial data: it reads and writes vector and raster data from and to practically every file format, or database, of significance. Package <code>sf</code> reads and writes using GDAL by the functions <code>st_read</code> and <code>st_write</code>.</p>
<p>The data model GDAL uses needs</p>
<ul>
<li>a data source, which may be a file, directory, or database</li>
<li>a layer, which is a single geospatial dataset inside a file or directory or e.g. a table in a database.</li>
<li>the specification of a driver (i.e., which format)</li>
<li>driver-specific reading or writing data sources, or layers</li>
</ul>
<p>This may sound complex, but it is needed to map to over 200 data formats! Package <code>sf</code> tries hard to simplify this where possible (e.g. a file contains a single layer), but this vignette will try to point you to the options.</p>
<div id="using-st_read" class="section level3">
<h3 class="hasAnchor">
<a href="#using-st_read" class="anchor"></a>Using st_read</h3>
<p>As an example, we read the North Carolina counties SIDS dataset, which comes shipped with the <code>sf</code> package by:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">sf</span>)
<span class="co">## Linking to GEOS 3.8.1, GDAL 3.1.2, PROJ 7.1.0</span>
<span class="no">fname</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"shape/nc.shp"</span>, <span class="kw">package</span><span class="kw">=</span><span class="st">"sf"</span>)
<span class="no">fname</span>
<span class="co">## [1] "/private/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/Rtmpv19OQa/temp_libpath39975faa9803/sf/shape/nc.shp"</span>
<span class="no">nc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/st_read.html">st_read</a></span>(<span class="no">fname</span>)
<span class="co">## Reading layer `nc' from data source `/private/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/Rtmpv19OQa/temp_libpath39975faa9803/sf/shape/nc.shp' using driver `ESRI Shapefile'</span>
<span class="co">## Simple feature collection with 100 features and 14 fields</span>
<span class="co">## geometry type:  MULTIPOLYGON</span>
<span class="co">## dimension:      XY</span>
<span class="co">## bbox:           xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965</span>
<span class="co">## geographic CRS: NAD27</span></pre></body></html></div>
<p>Typical users will use a file name with path for <code>fname</code>, or first set R’s working directory with <code><a href="https://rdrr.io/r/base/getwd.html">setwd()</a></code> and use file name without path.</p>
<p>We see here that a single argument is used to find both the datasource and the layer. This works when the datasource contains a single layer. In case the number of layers is zero (e.g. a database with no tables), an error message is given. In case there are more layers than one, the first layer is returned, but a message and a warning are given:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r">&gt; st_read("PG:dbname=postgis")
Multiple layers are present in data source PG:dbname=postgis, reading layer `meuse'.
Use `st_layers' to list all layer names and their type in a data source.
Set the `layer' argument in `st_read' to read a particular layer.
Reading layer `meuse' from data source `PG:dbname=postgis' using driver `PostgreSQL'
Simple feature collection with 155 features and 12 fields
geometry type:  POINT
dimension:      XY
bbox:           xmin: 178605 ymin: 329714 xmax: 181390 ymax: 333611
epsg (SRID):    28992
proj4string:    +proj=sterea +lat_0=52.15616055555555 ...
Warning message:
In eval(substitute(expr), envir, enclos) :
  automatically selected the first layer in a data source containing more than one.</pre></body></html></div>
<p>The message points to the <code>st_layers</code> command, which lists the driver and layers in a datasource, e.g.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r">&gt; st_layers("PG:dbname=postgis")
Driver: PostgreSQL 
Available layers:
  layer_name geometry_type features fields
1      meuse         Point      155     12
2   meuse_sf         Point      155     12
3       sids Multi Polygon      100     14
4  meuse_tbl         Point      155     13
5 meuse_tbl2         Point      155     13
&gt; </pre></body></html></div>
<p>A particular layer can now be read by e.g.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="../reference/st_read.html">st_read</a></span>(<span class="st">"PG:dbname=postgis"</span>, <span class="st">"sids"</span>)</pre></body></html></div>
<p><code>st_layers</code> has the option to count the number of features in case these are missing: some datasources (e.g. OSM xml files) do not report the number of features, but need to be completely read for this. GDAL allows for more than one geometry column for a feature layer; these are reported by <code>st_layers</code>.</p>
<p>In case a layer contains only geometries but no attributes (fields), <code>st_read</code> still returns an <code>sf</code> object, with a geometry column only.</p>
<p>We see that GDAL automatically detects the driver (file format) of the datasource, by trying them all in turn.</p>
<p><code>st_read</code> follows the conventions of base R, similar to how it reads tabular data into <code>data.frame</code>s. This means that character data are read, by default as <code>factor</code>s. For those who insist on retrieving character data as character vectors, the argument <code>stringsAsFactors</code> can be set to <code>FALSE</code>:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="../reference/st_read.html">st_read</a></span>(<span class="no">fname</span>, <span class="kw">stringsAsFactors</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<p>Alternatively, a user can set the global option <code>stringsAsFactors</code>, and this will have the same effect:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="kw">stringsAsFactors</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="../reference/st_read.html">st_read</a></span>(<span class="no">fname</span>)
<span class="co">## Reading layer `nc' from data source `/private/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/Rtmpv19OQa/temp_libpath39975faa9803/sf/shape/nc.shp' using driver `ESRI Shapefile'</span>
<span class="co">## Simple feature collection with 100 features and 14 fields</span>
<span class="co">## geometry type:  MULTIPOLYGON</span>
<span class="co">## dimension:      XY</span>
<span class="co">## bbox:           xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965</span>
<span class="co">## geographic CRS: NAD27</span></pre></body></html></div>
</div>
<div id="using-st_write" class="section level3">
<h3 class="hasAnchor">
<a href="#using-st_write" class="anchor"></a>Using st_write</h3>
<p>To write a simple features object to a file, we need at least two arguments, the object and a filename:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="../reference/st_write.html">st_write</a></span>(<span class="no">nc</span>, <span class="st">"nc1.shp"</span>)</pre></body></html></div>
<p>The file name is taken as the data source name. The default for the layer name is the basename (filename without path) of the the data source name. For this, <code>st_write</code> needs to guess the driver. The above command is, for instance, equivalent to:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="../reference/st_write.html">st_write</a></span>(<span class="no">nc</span>, <span class="kw">dsn</span> <span class="kw">=</span> <span class="st">"nc1.shp"</span>, <span class="kw">layer</span> <span class="kw">=</span> <span class="st">"nc.shp"</span>, <span class="kw">driver</span> <span class="kw">=</span> <span class="st">"ESRI Shapefile"</span>)
<span class="co">## Writing layer `nc' to data source `nc1.shp' using driver `ESRI Shapefile'</span>
<span class="co">## Writing 100 features with 14 fields and geometry type Multi Polygon.</span></pre></body></html></div>
<p>How the guessing of drivers works is explained in the next section.</p>
</div>
<div id="guessing-a-driver-for-output" class="section level3">
<h3 class="hasAnchor">
<a href="#guessing-a-driver-for-output" class="anchor"></a>Guessing a driver for output</h3>
<p>The output driver is guessed from the datasource name, either from its extension (<code>.shp</code>: <code>ESRI Shapefile</code>), or its prefix (<code>PG:</code>: <code>PostgreSQL</code>). The list of extensions with corresponding driver (short driver name) is:</p>
<table class="table">
<thead><tr class="header">
<th>extension</th>
<th>driver short name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>bna</code></td>
<td><code>BNA</code></td>
</tr>
<tr class="even">
<td><code>csv</code></td>
<td><code>CSV</code></td>
</tr>
<tr class="odd">
<td><code>e00</code></td>
<td><code>AVCE00</code></td>
</tr>
<tr class="even">
<td><code>gdb</code></td>
<td><code>FileGDB</code></td>
</tr>
<tr class="odd">
<td><code>geojson</code></td>
<td><code>GeoJSON</code></td>
</tr>
<tr class="even">
<td><code>gml</code></td>
<td><code>GML</code></td>
</tr>
<tr class="odd">
<td><code>gmt</code></td>
<td><code>GMT</code></td>
</tr>
<tr class="even">
<td><code>gpkg</code></td>
<td><code>GPKG</code></td>
</tr>
<tr class="odd">
<td><code>gps</code></td>
<td><code>GPSBabel</code></td>
</tr>
<tr class="even">
<td><code>gtm</code></td>
<td><code>GPSTrackMaker</code></td>
</tr>
<tr class="odd">
<td><code>gxt</code></td>
<td><code>Geoconcept</code></td>
</tr>
<tr class="even">
<td><code>jml</code></td>
<td><code>JML</code></td>
</tr>
<tr class="odd">
<td><code>map</code></td>
<td><code>WAsP</code></td>
</tr>
<tr class="even">
<td><code>mdb</code></td>
<td><code>Geomedia</code></td>
</tr>
<tr class="odd">
<td><code>nc</code></td>
<td><code>netCDF</code></td>
</tr>
<tr class="even">
<td><code>ods</code></td>
<td><code>ODS</code></td>
</tr>
<tr class="odd">
<td><code>osm</code></td>
<td><code>OSM</code></td>
</tr>
<tr class="even">
<td><code>pbf</code></td>
<td><code>OSM</code></td>
</tr>
<tr class="odd">
<td><code>shp</code></td>
<td><code>ESRI Shapefile</code></td>
</tr>
<tr class="even">
<td><code>sqlite</code></td>
<td><code>SQLite</code></td>
</tr>
<tr class="odd">
<td><code>vdv</code></td>
<td><code>VDV</code></td>
</tr>
<tr class="even">
<td><code>xls</code></td>
<td><code>xls</code></td>
</tr>
<tr class="odd">
<td><code>xlsx</code></td>
<td><code>XLSX</code></td>
</tr>
</tbody>
</table>
<p>The list with prefixes is:</p>
<table class="table">
<thead><tr class="header">
<th>prefix</th>
<th>driver short name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>couchdb:</code></td>
<td><code>CouchDB</code></td>
</tr>
<tr class="even">
<td><code>DB2ODBC:</code></td>
<td><code>DB2ODBC</code></td>
</tr>
<tr class="odd">
<td><code>DODS:</code></td>
<td><code>DODS</code></td>
</tr>
<tr class="even">
<td><code>GFT:</code></td>
<td><code>GFT</code></td>
</tr>
<tr class="odd">
<td><code>MSSQL:</code></td>
<td><code>MSSQLSpatial</code></td>
</tr>
<tr class="even">
<td><code>MySQL:</code></td>
<td><code>MySQL</code></td>
</tr>
<tr class="odd">
<td><code>OCI:</code></td>
<td><code>OCI</code></td>
</tr>
<tr class="even">
<td><code>ODBC:</code></td>
<td><code>ODBC</code></td>
</tr>
<tr class="odd">
<td><code>PG:</code></td>
<td><code>PostgreSQL</code></td>
</tr>
<tr class="even">
<td><code>SDE:</code></td>
<td><code>SDE</code></td>
</tr>
</tbody>
</table>
</div>
<div id="dataset-and-layer-reading-or-creation-options" class="section level3">
<h3 class="hasAnchor">
<a href="#dataset-and-layer-reading-or-creation-options" class="anchor"></a>Dataset and layer reading or creation options</h3>
<p>Various GDAL drivers have options that influences the reading or writing process, for example what the driver should do when a table already exists in a database: append records to the table or overwrite it:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="../reference/st_write.html">st_write</a></span>(<span class="fu"><a href="../reference/st_as_sf.html">st_as_sf</a></span>(<span class="no">meuse</span>), <span class="st">"PG:dbname=postgis"</span>, <span class="st">"meuse"</span>,
    <span class="kw">layer_options</span> <span class="kw">=</span> <span class="st">"OVERWRITE=true"</span>)</pre></body></html></div>
<p>In case the table exists and the option is not specified, the driver will give an error. Driver-specific options are documented in the driver manual of <a href="http://www.gdal.org/ogr_formats.html">gdal</a>. Multiple options can be given by multiple strings in <code>options</code>.</p>
<p>For <code>st_read</code>, there is only <code>options</code>; for <code>st_write</code>, one needs to distinguish between <code>dataset_options</code> and <code>layer_options</code>, the first related to opening a dataset, the second to creating layers in the dataset.</p>
</div>
</div>
<div id="reading-and-writing-directly-to-and-from-spatial-databases" class="section level2">
<h2 class="hasAnchor">
<a href="#reading-and-writing-directly-to-and-from-spatial-databases" class="anchor"></a>Reading and writing directly to and from spatial databases</h2>
<p>Package <code>sf</code> supports reading and writing from and to spatial databases using the <code>DBI</code> interface. So far, testing has mainly be done with <code>PostGIS</code>, other databases might work but may also need more work. An example of reading is:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">RPostgreSQL</span>)
<span class="no">conn</span> <span class="kw">=</span> <span class="fu">dbConnect</span>(<span class="fu"><a href="https://rdrr.io/pkg/RPostgreSQL/man/PostgreSQL.html">PostgreSQL</a></span>(), <span class="kw">dbname</span> <span class="kw">=</span> <span class="st">"postgis"</span>)
<span class="no">meuse</span> <span class="kw">=</span> <span class="fu"><a href="../reference/st_read.html">st_read</a></span>(<span class="no">conn</span>, <span class="st">"meuse"</span>)
<span class="no">meuse_1_3</span> <span class="kw">=</span> <span class="fu"><a href="../reference/st_read.html">st_read</a></span>(<span class="no">conn</span>, <span class="kw">query</span> <span class="kw">=</span> <span class="st">"select * from meuse limit 3;"</span>)
<span class="fu">dbDisconnect</span>(<span class="no">conn</span>)</pre></body></html></div>
<p>We see here that in the second example a query is given. This query may contain spatial predicates, which could be a way to work through massive spatial datasets in R without having to read them completely in memory.</p>
<p>Similarly, tables can be written:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">conn</span> <span class="kw">=</span> <span class="fu">dbConnect</span>(<span class="fu"><a href="https://rdrr.io/pkg/RPostgreSQL/man/PostgreSQL.html">PostgreSQL</a></span>(), <span class="kw">dbname</span> <span class="kw">=</span> <span class="st">"postgis"</span>)
<span class="fu"><a href="../reference/st_write.html">st_write</a></span>(<span class="no">conn</span>, <span class="no">meuse</span>, <span class="kw">drop</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu">dbDisconnect</span>(<span class="no">conn</span>)</pre></body></html></div>
<p>Here, the default table (layer) name is taken from the object name (<code>meuse</code>). Argument <code>drop</code> informs to drop (remove) the table before writing; logical argument <code>binary</code> determines whether to use well-known binary or well-known text when writing the geometry (where well-known binary is faster and lossless).</p>
</div>
<div id="conversion-to-other-formats-wkt-wkb-sp" class="section level2">
<h2 class="hasAnchor">
<a href="#conversion-to-other-formats-wkt-wkb-sp" class="anchor"></a>Conversion to other formats: WKT, WKB, sp</h2>
<div id="conversion-to-and-from-well-known-text" class="section level3">
<h3 class="hasAnchor">
<a href="#conversion-to-and-from-well-known-text" class="anchor"></a>Conversion to and from well-known text</h3>
<p>The usual form in which we see simple features printed is well-known text:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="../reference/st.html">st_point</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">1</span>))
<span class="co">## POINT (0 1)</span>
<span class="fu"><a href="../reference/st.html">st_linestring</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>:<span class="fl">9</span>,<span class="kw">ncol</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">byrow</span><span class="kw">=</span><span class="fl">TRUE</span>))
<span class="co">## LINESTRING (0 1, 2 3, 4 5, 6 7, 8 9)</span></pre></body></html></div>
<p>We can create these well-known text strings explicitly using <code>st_as_text</code>:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">x</span> <span class="kw">=</span> <span class="fu"><a href="../reference/st.html">st_linestring</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>:<span class="fl">9</span>,<span class="kw">ncol</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">byrow</span><span class="kw">=</span><span class="fl">TRUE</span>))
<span class="no">str</span> <span class="kw">=</span> <span class="fu"><a href="../reference/st_as_text.html">st_as_text</a></span>(<span class="no">x</span>)
<span class="no">x</span>
<span class="co">## LINESTRING (0 1, 2 3, 4 5, 6 7, 8 9)</span></pre></body></html></div>
<p>We can convert back from WKT by using <code>st_as_sfc</code>:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="../reference/st_as_sfc.html">st_as_sfc</a></span>(<span class="no">str</span>)
<span class="co">## Geometry set for 1 feature </span>
<span class="co">## geometry type:  LINESTRING</span>
<span class="co">## dimension:      XY</span>
<span class="co">## bbox:           xmin: 0 ymin: 1 xmax: 8 ymax: 9</span>
<span class="co">## CRS:            NA</span>
<span class="co">## LINESTRING (0 1, 2 3, 4 5, 6 7, 8 9)</span></pre></body></html></div>
</div>
<div id="conversion-to-and-from-well-known-binary" class="section level3">
<h3 class="hasAnchor">
<a href="#conversion-to-and-from-well-known-binary" class="anchor"></a>Conversion to and from well-known binary</h3>
<p>Well-known binary is created from simple features by <code>st_as_binary</code>:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">x</span> <span class="kw">=</span> <span class="fu"><a href="../reference/st.html">st_linestring</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>:<span class="fl">9</span>,<span class="kw">ncol</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">byrow</span><span class="kw">=</span><span class="fl">TRUE</span>))
(<span class="no">x</span> <span class="kw">=</span> <span class="fu"><a href="../reference/st_as_binary.html">st_as_binary</a></span>(<span class="no">x</span>))
<span class="co">##  [1] 01 02 00 00 00 05 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f0 3f</span>
<span class="co">## [26] 00 00 00 00 00 00 00 40 00 00 00 00 00 00 08 40 00 00 00 00 00 00 10 40 00</span>
<span class="co">## [51] 00 00 00 00 00 14 40 00 00 00 00 00 00 18 40 00 00 00 00 00 00 1c 40 00 00</span>
<span class="co">## [76] 00 00 00 00 20 40 00 00 00 00 00 00 22 40</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span>(<span class="no">x</span>)
<span class="co">## [1] "raw"</span></pre></body></html></div>
<p>The object returned by <code>st_as_binary</code> is of class <code>WKB</code> and is either a list with raw vectors, or a single raw vector. These can be converted into a hexadecimal character vector using <code>rawToHex</code>:</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="../reference/rawToHex.html">rawToHex</a></span>(<span class="no">x</span>)
<span class="co">## [1] "0102000000050000000000000000000000000000000000f03f000000000000004000000000000008400000000000001040000000000000144000000000000018400000000000001c4000000000000020400000000000002240"</span></pre></body></html></div>
<p>Converting back to <code>sf</code> uses <code>st_as_sfc</code>:</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">x</span> <span class="kw">=</span> <span class="fu"><a href="../reference/st_as_binary.html">st_as_binary</a></span>(<span class="fu"><a href="../reference/sfc.html">st_sfc</a></span>(<span class="fu"><a href="../reference/st.html">st_point</a></span>(<span class="fl">0</span>:<span class="fl">1</span>), <span class="fu"><a href="../reference/st.html">st_point</a></span>(<span class="fl">5</span>:<span class="fl">6</span>)))
<span class="fu"><a href="../reference/st_as_sfc.html">st_as_sfc</a></span>(<span class="no">x</span>)
<span class="co">## Geometry set for 2 features </span>
<span class="co">## geometry type:  POINT</span>
<span class="co">## dimension:      XY</span>
<span class="co">## bbox:           xmin: 0 ymin: 1 xmax: 5 ymax: 6</span>
<span class="co">## CRS:            NA</span>
<span class="co">## POINT (0 1)</span>
<span class="co">## POINT (5 6)</span></pre></body></html></div>
</div>
<div id="conversion-to-and-from-sp" class="section level3">
<h3 class="hasAnchor">
<a href="#conversion-to-and-from-sp" class="anchor"></a>Conversion to and from sp</h3>
<p>Spatial objects as maintained by package <code>sp</code> can be converted into simple feature objects or geometries by <code>st_as_sf</code> and <code>st_as_sfc</code>, respectively:</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/methods.html">methods</a></span>(<span class="no">st_as_sf</span>)
<span class="co">## [1] st_as_sf.data.frame* st_as_sf.lpp*        st_as_sf.map*       </span>
<span class="co">## [4] st_as_sf.owin*       st_as_sf.ppp*        st_as_sf.psp*       </span>
<span class="co">## [7] st_as_sf.sf*         st_as_sf.sfc*        st_as_sf.Spatial*   </span>
<span class="co">## see '?methods' for accessing help and source code</span>
<span class="fu"><a href="https://rdrr.io/r/utils/methods.html">methods</a></span>(<span class="no">st_as_sfc</span>)
<span class="co">##  [1] st_as_sfc.bbox*               st_as_sfc.blob*              </span>
<span class="co">##  [3] st_as_sfc.character*          st_as_sfc.dimensions*        </span>
<span class="co">##  [5] st_as_sfc.factor*             st_as_sfc.list*              </span>
<span class="co">##  [7] st_as_sfc.map*                st_as_sfc.owin*              </span>
<span class="co">##  [9] st_as_sfc.pq_geometry*        st_as_sfc.psp*               </span>
<span class="co">## [11] st_as_sfc.raw*                st_as_sfc.s2_geography*      </span>
<span class="co">## [13] st_as_sfc.SpatialLines*       st_as_sfc.SpatialMultiPoints*</span>
<span class="co">## [15] st_as_sfc.SpatialPixels*      st_as_sfc.SpatialPoints*     </span>
<span class="co">## [17] st_as_sfc.SpatialPolygons*    st_as_sfc.tess*              </span>
<span class="co">## [19] st_as_sfc.wk_wkb*             st_as_sfc.WKB*               </span>
<span class="co">## see '?methods' for accessing help and source code</span></pre></body></html></div>
<p>An example would be:</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">sp</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">meuse</span>)
<span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html">coordinates</a></span>(<span class="no">meuse</span>) <span class="kw">=</span> ~<span class="no">x</span>+<span class="no">y</span>
<span class="no">m.sf</span> <span class="kw">=</span> <span class="fu"><a href="../reference/st_as_sf.html">st_as_sf</a></span>(<span class="no">meuse</span>)
<span class="no">opar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>,<span class="fl">4</span>))
<span class="fu"><a href="../reference/plot.html">plot</a></span>(<span class="no">m.sf</span>)
<span class="co">## Warning: plotting the first 10 out of 12 attributes; use max.plot = 12 to plot</span>
<span class="co">## all</span></pre></body></html></div>
<p><img src="sf2_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p>Conversion of simple feature objects of class <code>sf</code> or <code>sfc</code> into corresponding <code>Spatial*</code> objects is done using the <code>as</code> method, coercing to <code>Spatial</code>:</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">x</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sfc.html">st_sfc</a></span>(<span class="fu"><a href="../reference/st.html">st_point</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>,<span class="fl">5</span>)), <span class="fu"><a href="../reference/st.html">st_point</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">6</span>,<span class="fl">9</span>)), <span class="kw">crs</span> <span class="kw">=</span> <span class="fl">4326</span>)
<span class="fu"><a href="../reference/coerce-methods.html">as</a></span>(<span class="no">x</span>, <span class="st">"Spatial"</span>)
<span class="co">## SpatialPoints:</span>
<span class="co">##      coords.x1 coords.x2</span>
<span class="co">## [1,]         5         5</span>
<span class="co">## [2,]         6         9</span>
<span class="co">## Coordinate Reference System (CRS) arguments: +proj=longlat +datum=WGS84</span>
<span class="co">## +no_defs</span></pre></body></html></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Edzer Pebesma.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
